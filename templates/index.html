<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì–‘í•œë¹ˆ ì´ë ¥ì„œ ë°ì´í„° ê´€ë¦¬</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Malgun Gothic', sans-serif;
            background: #f5f5f5;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        h1 {
            font-size: 24px;
            margin-bottom: 10px;
            color: #333;
        }

        .subtitle {
            color: #666;
            margin-bottom: 30px;
            font-size: 14px;
        }

        .tabs {
            border-bottom: 2px solid #ddd;
            margin-bottom: 20px;
        }

        .tab-btn {
            background: none;
            border: none;
            padding: 12px 20px;
            cursor: pointer;
            font-size: 14px;
            color: #666;
            border-bottom: 3px solid transparent;
            margin-right: 5px;
        }

        .tab-btn:hover {
            background: #f9f9f9;
        }

        .tab-btn.active {
            color: #2196F3;
            border-bottom-color: #2196F3;
            font-weight: bold;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .section-title {
            font-size: 18px;
            font-weight: bold;
            margin: 20px 0 10px 0;
            color: #333;
            border-left: 4px solid #2196F3;
            padding-left: 10px;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            font-size: 13px;
        }

        .data-table th {
            background: #f0f0f0;
            border: 1px solid #ccc;
            padding: 10px;
            text-align: center;
            font-weight: bold;
            color: #333;
        }

        .data-table td {
            border: 1px solid #ccc;
            padding: 8px;
            text-align: center;
        }

        .data-table tr:hover {
            background: #f9f9f9;
        }

        .action-buttons {
            margin: 15px 0;
        }

        .btn {
            padding: 8px 16px;
            border: 1px solid #ddd;
            background: white;
            cursor: pointer;
            font-size: 13px;
            margin-right: 5px;
            border-radius: 3px;
        }

        .btn:hover {
            background: #f5f5f5;
        }

        .btn-primary {
            background: #2196F3;
            color: white;
            border-color: #2196F3;
        }

        .btn-primary:hover {
            background: #1976D2;
        }

        .btn-success {
            background: #4CAF50;
            color: white;
            border-color: #4CAF50;
        }

        .btn-success:hover {
            background: #45a049;
        }

        .info-box {
            background: #f9f9f9;
            border: 1px solid #ddd;
            padding: 15px;
            margin: 15px 0;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #999;
        }

        /* ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 5px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 20px;
            border-bottom: 2px solid #ddd;
            padding-bottom: 10px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #333;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 3px;
            font-size: 13px;
        }

        .form-group textarea {
            min-height: 80px;
            resize: vertical;
        }

        .btn-danger {
            background: #f44336;
            color: white;
            border-color: #f44336;
        }

        .btn-danger:hover {
            background: #d32f2f;
        }

        .action-cell {
            white-space: nowrap;
        }

        .btn-small {
            padding: 4px 8px;
            font-size: 12px;
            margin: 0 2px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ì–‘í•œë¹ˆ ì´ë ¥ì„œ ë°ì´í„° ê´€ë¦¬</h1>
        <div class="subtitle">ë³µì‚¬-ë¶™ì—¬ë„£ê¸° ê°€ëŠ¥í•œ í‘œ í˜•ì‹ ë°ì´í„° ê´€ë¦¬</div>

        <div class="tabs">
            <button class="tab-btn active" onclick="showTab('grades')">ì„±ì  ë°ì´í„°</button>
            <button class="tab-btn" onclick="showTab('certifications')">ìê²©ì¦</button>
            <button class="tab-btn" onclick="showTab('awards')">ìˆ˜ìƒ</button>
            <button class="tab-btn" onclick="showTab('activities')">í™œë™</button>
            <button class="tab-btn" onclick="showTab('projects')">í”„ë¡œì íŠ¸</button>
            <button class="tab-btn" onclick="showTab('career')">ê²½ë ¥</button>
        </div>

        <!-- ì„±ì  ë°ì´í„° íƒ­ -->
        <div id="grades" class="tab-content active">
            <div class="section-title">ì „ì²´ ì„±ì  (ë¶€ì‚°ëŒ€í•™êµ)</div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="openAddModal('grade')">â• ì„±ì  ì¶”ê°€</button>
                <button class="btn btn-primary" onclick="copyTable('grades-table')">ğŸ“‹ í‘œ ë³µì‚¬</button>
                <button class="btn btn-success" onclick="downloadExcel('grades')">ğŸ“Š ì—‘ì…€ ë‹¤ìš´ë¡œë“œ</button>
            </div>
            <div id="grades-content">
                <table class="data-table" id="grades-table">
                    <thead>
                        <tr>
                            <th>í•™ë…„ë„</th>
                            <th>í•™ê¸°</th>
                            <th>ì„±ì ë¶„ë¥˜</th>
                            <th>êµê³¼êµ¬ë¶„</th>
                            <th>êµê³¼ëª©ëª…</th>
                            <th>í•™ì </th>
                            <th>ì„±ì ë“±ê¸‰</th>
                            <th>ë¹„ê³ </th>
                            <th>ê´€ë¦¬</th>
                        </tr>
                    </thead>
                    <tbody id="grades-tbody">
                        <tr><td colspan="9" class="loading">ë°ì´í„° ë¡œë”© ì¤‘...</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- ìê²©ì¦ íƒ­ -->
        <div id="certifications" class="tab-content">
            <div class="section-title">ìê²©ì¦ ì •ë³´</div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="openAddModal('cert')">â• ìê²©ì¦ ì¶”ê°€</button>
                <button class="btn btn-primary" onclick="copyTable('cert-table')">ğŸ“‹ í‘œ ë³µì‚¬</button>
                <button class="btn btn-success" onclick="downloadExcel('certifications')">ğŸ“Š ì—‘ì…€ ë‹¤ìš´ë¡œë“œ</button>
            </div>
            <table class="data-table" id="cert-table">
                <thead>
                    <tr>
                        <th>No</th>
                        <th>ìê²©ì¦ëª…</th>
                        <th>ë“±ê¸‰</th>
                        <th>ë°œí–‰ì²˜</th>
                        <th>ì·¨ë“ì¼</th>
                        <th>ìê²©ì¦ë²ˆí˜¸</th>
                        <th>ê´€ë¦¬</th>
                    </tr>
                </thead>
                <tbody id="cert-tbody">
                    <tr><td colspan="7" class="loading">ë°ì´í„° ë¡œë”© ì¤‘...</td></tr>
                </tbody>
            </table>
        </div>

        <!-- ìˆ˜ìƒ íƒ­ -->
        <div id="awards" class="tab-content">
            <div class="section-title">ìˆ˜ìƒ ë‚´ì—­</div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="copyTable('awards-table')">ğŸ“‹ í‘œ ë³µì‚¬</button>
                <button class="btn btn-success" onclick="downloadExcel('awards')">ğŸ“Š ì—‘ì…€ ë‹¤ìš´ë¡œë“œ</button>
            </div>
            <table class="data-table" id="awards-table">
                <thead>
                    <tr>
                        <th>No</th>
                        <th>ìˆ˜ìƒëª…</th>
                        <th>ìˆ˜ì—¬ê¸°ê´€</th>
                        <th>ìˆ˜ìƒì¼ì</th>
                    </tr>
                </thead>
                <tbody id="awards-tbody">
                    <tr><td colspan="4" class="loading">ë°ì´í„° ë¡œë”© ì¤‘...</td></tr>
                </tbody>
            </table>
        </div>

        <!-- í™œë™ íƒ­ -->
        <div id="activities" class="tab-content">
            <div class="section-title">ëŒ€ë‚´ì™¸ í™œë™</div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="copyTable('activities-table')">ğŸ“‹ í‘œ ë³µì‚¬</button>
                <button class="btn btn-success" onclick="downloadExcel('activities')">ğŸ“Š ì—‘ì…€ ë‹¤ìš´ë¡œë“œ</button>
            </div>
            <table class="data-table" id="activities-table">
                <thead>
                    <tr>
                        <th>No</th>
                        <th>í™œë™ëª…</th>
                        <th>ì£¼ê´€ê¸°ê´€</th>
                        <th>ì‹œì‘ì¼</th>
                        <th>ì¢…ë£Œì¼</th>
                        <th>ë‚´ìš©</th>
                    </tr>
                </thead>
                <tbody id="activities-tbody">
                    <tr><td colspan="6" class="loading">ë°ì´í„° ë¡œë”© ì¤‘...</td></tr>
                </tbody>
            </table>
        </div>

        <!-- í”„ë¡œì íŠ¸ íƒ­ -->
        <div id="projects" class="tab-content">
            <div class="section-title">í”„ë¡œì íŠ¸ ê²½í—˜</div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="copyTable('projects-table')">ğŸ“‹ í‘œ ë³µì‚¬</button>
                <button class="btn btn-success" onclick="downloadExcel('projects')">ğŸ“Š ì—‘ì…€ ë‹¤ìš´ë¡œë“œ</button>
            </div>
            <table class="data-table" id="projects-table">
                <thead>
                    <tr>
                        <th>No</th>
                        <th>í”„ë¡œì íŠ¸ëª…</th>
                        <th>ê¸°ê°„</th>
                        <th>ì¸ì›</th>
                        <th>ì—­í• </th>
                        <th>ê¸°ìˆ ìŠ¤íƒ</th>
                        <th>ì„¤ëª…</th>
                    </tr>
                </thead>
                <tbody id="projects-tbody">
                    <tr><td colspan="7" class="loading">ë°ì´í„° ë¡œë”© ì¤‘...</td></tr>
                </tbody>
            </table>
        </div>

        <!-- ê²½ë ¥ íƒ­ -->
        <div id="career" class="tab-content">
            <div class="section-title">ê²½ë ¥ ì‚¬í•­</div>
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="copyTable('career-table')">ğŸ“‹ í‘œ ë³µì‚¬</button>
                <button class="btn btn-success" onclick="downloadExcel('career')">ğŸ“Š ì—‘ì…€ ë‹¤ìš´ë¡œë“œ</button>
            </div>
            <table class="data-table" id="career-table">
                <thead>
                    <tr>
                        <th>No</th>
                        <th>ê¸°ì—…ëª…</th>
                        <th>ì§ê¸‰</th>
                        <th>ì…ì‚¬ì¼</th>
                        <th>í‡´ì‚¬ì¼</th>
                        <th>ë‹´ë‹¹ì—…ë¬´</th>
                    </tr>
                </thead>
                <tbody id="career-tbody">
                    <tr><td colspan="6" class="loading">ë°ì´í„° ë¡œë”© ì¤‘...</td></tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- ëª¨ë‹¬ -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <div class="modal-header" id="modal-title">ë°ì´í„° ì¶”ê°€</div>
            <div id="modal-body"></div>
            <div style="margin-top: 20px; text-align: right;">
                <button class="btn" onclick="closeModal()">ì·¨ì†Œ</button>
                <button class="btn btn-primary" onclick="saveData()">ì €ì¥</button>
            </div>
        </div>
    </div>

    <script>
        // ì„±ì  ë°ì´í„° (ì„±ì ì¦ëª…ì„œ ê¸°ë°˜)
        const gradesData = [
            {year: '2019', semester: '1í•™ê¸°', type: 'ì •ê·œí•™ê¸°', category: 'êµì–‘ì„ íƒ', subject: 'ì„¸ê³„ë¬¸í™”ìœ ì‚°ì˜ì´í•´', credit: '3.0', grade: 'C+', note: '1ì˜ì—­ : ì‚¬ìƒê³¼ì—­ì‚¬'},
            {year: '2019', semester: '1í•™ê¸°', type: 'ì •ê·œí•™ê¸°', category: 'êµì–‘ì„ íƒ', subject: 'ì²´í—˜ê´€ê´‘ê³¼ ë™.ì„œì–‘ ë¬¸í™” ì´í•´', credit: '3.0', grade: 'C0', note: '2ì˜ì—­ : ì‚¬íšŒì™€ë¬¸í™”'},
            {year: '2019', semester: '1í•™ê¸°', type: 'ì •ê·œí•™ê¸°', category: 'êµì–‘í•„ìˆ˜', subject: 'ê³ ì „ì½ê¸°ì™€í† ë¡ ', credit: '2.0', grade: 'B+', note: ''},
            {year: '2019', semester: '1í•™ê¸°', type: 'ì •ê·œí•™ê¸°', category: 'ì „ê³µê¸°ì´ˆ', subject: 'ê²½ì˜ê³¼ ì¸ì„±', credit: '1.0', grade: 'S', note: ''},
            {year: '2019', semester: '1í•™ê¸°', type: 'ì •ê·œí•™ê¸°', category: 'ì „ê³µê¸°ì´ˆ', subject: 'ê²½ì œí•™ì›ë¡ ', credit: '3.0', grade: 'A0', note: ''},
            {year: '2019', semester: '2í•™ê¸°', type: 'ì •ê·œí•™ê¸°', category: 'êµì–‘ì„ íƒ', subject: 'ìš•ë§ê³¼ì² í•™', credit: '3.0', grade: 'A+', note: '1ì˜ì—­ : ì‚¬ìƒê³¼ì—­ì‚¬'},
            {year: '2019', semester: '2í•™ê¸°', type: 'ì •ê·œí•™ê¸°', category: 'êµì–‘í•„ìˆ˜', subject: 'ì—´ë¦°ì‚¬ê³ ì™€í‘œí˜„', credit: '2.0', grade: 'B+', note: ''},
            {year: '2019', semester: '2í•™ê¸°', type: 'ì •ê·œí•™ê¸°', category: 'êµì–‘í•„ìˆ˜', subject: 'ì»´í“¨íŒ…ì‚¬ê³ ', credit: '1.5', grade: 'B+', note: ''},
            {year: '2019', semester: '2í•™ê¸°', type: 'ì •ê·œí•™ê¸°', category: 'ì „ê³µê¸°ì´ˆ', subject: 'ê²½ì˜í†µê³„í•™', credit: '3.0', grade: 'A0', note: ''},
            {year: '2019', semester: '2í•™ê¸°', type: 'ì •ê·œí•™ê¸°', category: 'ì „ê³µê¸°ì´ˆ', subject: 'íšŒê³„í•™ì›ë¦¬', credit: '3.0', grade: 'A0', note: ''},
            {year: '2022', semester: '1í•™ê¸°', type: 'ì •ê·œí•™ê¸°', category: 'êµì–‘ì„ íƒ', subject: 'ì˜ì–´í‘œí˜„ì—°ìŠµ(I)', credit: '3.0', grade: 'B+', note: '6ì˜ì—­ : ì™¸êµ­ì–´'},
            {year: '2022', semester: '1í•™ê¸°', type: 'ì •ê·œí•™ê¸°', category: 'êµì–‘ì„ íƒ', subject: 'ì¸ê°„í–‰ë™ê³¼ì‹¬ë¦¬', credit: '3.0', grade: 'C+', note: '2ì˜ì—­ : ì‚¬íšŒì™€ë¬¸í™”'},
            {year: '2022', semester: '1í•™ê¸°', type: 'ì •ê·œí•™ê¸°', category: 'êµì–‘í•„ìˆ˜', subject: 'ëŒ€í•™ì‹¤ìš©ì˜ì–´(II)', credit: '2.0', grade: 'A+', note: ''},
            {year: '2022', semester: '1í•™ê¸°', type: 'ì •ê·œí•™ê¸°', category: 'ì „ê³µê¸°ì´ˆ', subject: 'ê²½ì˜í•™ì›ë¡ ', credit: '3.0', grade: 'B0', note: ''},
            {year: '2022', semester: '1í•™ê¸°', type: 'ì •ê·œí•™ê¸°', category: 'ì „ê³µí•„ìˆ˜', subject: 'ë§ˆì¼€íŒ…ê´€ë¦¬', credit: '3.0', grade: 'B+', note: ''},
            {year: '2022', semester: '1í•™ê¸°', type: 'ì •ê·œí•™ê¸°', category: 'ì „ê³µí•„ìˆ˜', subject: 'ì˜¤í¼ë ˆì´ì…˜ìŠ¤ ë§¤ë‹ˆì§€ë¨¼íŠ¸', credit: '3.0', grade: 'A+', note: ''},
            {year: '2022', semester: '1í•™ê¸°', type: 'ì •ê·œí•™ê¸°', category: 'ì „ê³µí•„ìˆ˜', subject: 'ì¬ë¬´íšŒê³„(I)', credit: '3.0', grade: 'A0', note: ''},
            {year: '2022', semester: '2í•™ê¸°', type: 'ì •ê·œí•™ê¸°', category: 'êµì–‘ì„ íƒ', subject: 'ê·¼ë ¥íŠ¸ë ˆì´ë‹ì²˜ë°©', credit: '1.5', grade: 'A0', note: '5ì˜ì—­ : ê±´ê°•ê³¼ë ˆí¬ì¸ '},
            {year: '2022', semester: '2í•™ê¸°', type: 'ì •ê·œí•™ê¸°', category: 'ì „ê³µì„ íƒ', subject: 'ê´‘ê³ ë¡ ', credit: '3.0', grade: 'B+', note: ''},
            {year: '2022', semester: '2í•™ê¸°', type: 'ì •ê·œí•™ê¸°', category: 'ì „ê³µì„ íƒ', subject: 'ë°ì´í„°ë² ì´ìŠ¤ê´€ë¦¬', credit: '3.0', grade: 'C+', note: ''},
            {year: '2022', semester: '2í•™ê¸°', type: 'ì •ê·œí•™ê¸°', category: 'ì „ê³µì„ íƒ', subject: 'ì°½ì—…ê³¼ê¸°ì—…ê°€ì •ì‹ ', credit: '3.0', grade: 'B+', note: ''},
            {year: '2022', semester: '2í•™ê¸°', type: 'ì •ê·œí•™ê¸°', category: 'ì „ê³µí•„ìˆ˜', subject: 'ì¸ì ìì›ê´€ë¦¬', credit: '3.0', grade: 'B+', note: ''},
            {year: '2022', semester: '2í•™ê¸°', type: 'ì •ê·œí•™ê¸°', category: 'ì „ê³µí•„ìˆ˜', subject: 'ì¬ë¬´ê´€ë¦¬', credit: '3.0', grade: 'B+', note: ''},
            {year: '2023', semester: '1í•™ê¸°', type: 'ì •ê·œí•™ê¸°', category: 'êµì–‘ì„ íƒ', subject: 'ê¸°ì—…ê°€ì •ì‹ ê³¼ ì°½ì˜ì  ì‚¬ê³ ', credit: '2.0', grade: 'S', note: '7ì˜ì—­ : ìœµë³µí•©'},
            {year: '2023', semester: '1í•™ê¸°', type: 'ì •ê·œí•™ê¸°', category: 'ë¶€ì „ê³µ', subject: 'ì˜ìƒë§¤ì²´ì´ë¡ ', credit: '3.0', grade: 'B+', note: ''},
            {year: '2023', semester: '1í•™ê¸°', type: 'ì •ê·œí•™ê¸°', category: 'ë¶€ì „ê³µ', subject: 'ì˜í™”í•™ì…ë¬¸', credit: '3.0', grade: 'B+', note: ''},
            {year: '2023', semester: '1í•™ê¸°', type: 'ì •ê·œí•™ê¸°', category: 'ì „ê³µì„ íƒ', subject: 'êµ­ì œì•„ì›ƒì†Œì‹±ì „ëµ', credit: '3.0', grade: 'B+', note: ''},
            {year: '2023', semester: '1í•™ê¸°', type: 'ì •ê·œí•™ê¸°', category: 'ì „ê³µì„ íƒ', subject: 'ì†Œë¹„ìí–‰ë™ë¡ ', credit: '3.0', grade: 'A+', note: ''},
            {year: '2023', semester: '1í•™ê¸°', type: 'ì •ê·œí•™ê¸°', category: 'ì „ê³µí•„ìˆ˜', subject: 'íˆ¬ìë¡ ', credit: '3.0', grade: 'A0', note: ''},
            {year: '2023', semester: 'ì—¬ë¦„', type: 'ê³„ì ˆìˆ˜ì—…', category: 'êµì–‘í•„ìˆ˜', subject: 'ê¸°ì´ˆì»´í“¨í„°í”„ë¡œê·¸ë˜ë°', credit: '1.5', grade: 'A+', note: ''},
            {year: '2023', semester: 'ì—¬ë¦„', type: 'ê³„ì ˆìˆ˜ì—…', category: 'ì „ê³µí•„ìˆ˜', subject: 'êµ­ì œê²½ì˜í•™', credit: '3.0', grade: 'B+', note: ''},
            {year: '2023', semester: '2í•™ê¸°', type: 'ì •ê·œí•™ê¸°', category: 'ë¶€ì „ê³µ', subject: 'ì˜ˆìˆ ì‚¬ì¡°ì™€ì˜ˆìˆ ìš´ë™', credit: '3.0', grade: 'C+', note: ''},
            {year: '2023', semester: '2í•™ê¸°', type: 'ì •ê·œí•™ê¸°', category: 'ë¶€ì „ê³µ', subject: 'í•œêµ­ì˜í™”ì˜ ì—­ì‚¬ì™€ ì „ë§', credit: '3.0', grade: 'B+', note: ''},
            {year: '2023', semester: '2í•™ê¸°', type: 'ì •ê·œí•™ê¸°', category: 'ì¼ë°˜ì„ íƒ', subject: 'ëŒ€ì¸ê´€ê³„ëŠ¥ë ¥ê³¼ì˜ì‚¬ì†Œí†µê¸°ìˆ ', credit: '3.0', grade: 'S', note: ''},
            {year: '2023', semester: '2í•™ê¸°', type: 'ì •ê·œí•™ê¸°', category: 'ì¼ë°˜ì„ íƒ', subject: 'ì§„ë¡œíƒìƒ‰ê³¼ ìƒì• ì„¤ê³„', credit: '3.0', grade: 'S', note: ''},
            {year: '2023', semester: '2í•™ê¸°', type: 'ì •ê·œí•™ê¸°', category: 'ì „ê³µì„ íƒ', subject: 'ë¹…ë°ì´í„°ë¹„ì¦ˆë‹ˆìŠ¤', credit: '3.0', grade: 'C+', note: ''},
            {year: '2023', semester: '2í•™ê¸°', type: 'ì •ê·œí•™ê¸°', category: 'ì „ê³µí•„ìˆ˜', subject: 'ê´€ë¦¬íšŒê³„', credit: '3.0', grade: 'B+', note: ''},
            {year: '2024', semester: '2í•™ê¸°', type: 'ì •ê·œí•™ê¸°', category: 'êµì–‘ì„ íƒ', subject: 'ì„±ê³¼ì‚¬ë‘ì˜ì² í•™', credit: '3.0', grade: 'A+', note: '2ì˜ì—­ : ì‚¬íšŒì™€ë¬¸í™”'},
            {year: '2024', semester: '2í•™ê¸°', type: 'ì •ê·œí•™ê¸°', category: 'ë¶€ì „ê³µ', subject: 'ì˜ˆìˆ ê²½ì˜ì…ë¬¸', credit: '3.0', grade: 'B+', note: ''},
            {year: '2024', semester: '2í•™ê¸°', type: 'ì •ê·œí•™ê¸°', category: 'ì¼ë°˜ì„ íƒ', subject: 'ì·¨ì—…ì‹¤ì „ì „ëµ(I)-ìê¸°ì†Œê°œì„œë°ë©´ì ‘ì¤€ë¹„ë²•', credit: '3.0', grade: 'S', note: ''},
            {year: '2024', semester: '2í•™ê¸°', type: 'ì •ê·œí•™ê¸°', category: 'ì¼ë°˜ì„ íƒ', subject: 'PNU TOEFLê¸°ì´ˆ', credit: '3.0', grade: 'S', note: ''},
            {year: '2024', semester: '2í•™ê¸°', type: 'ì •ê·œí•™ê¸°', category: 'ì „ê³µì„ íƒ', subject: 'ì¡°ì§í–‰ìœ„ë¡ ', credit: '3.0', grade: 'A0', note: ''},
            {year: '2025', semester: '1í•™ê¸°', type: 'ì •ê·œí•™ê¸°', category: 'ë¶€ì „ê³µ', subject: 'ë¯¸í•™ì…ë¬¸', credit: '3.0', grade: 'B+', note: ''},
            {year: '2025', semester: '1í•™ê¸°', type: 'ì •ê·œí•™ê¸°', category: 'ë¶€ì „ê³µ', subject: 'ì„¸ê³„ì˜í™”ì˜ ì—­ì‚¬ì™€ ì „ë§', credit: '3.0', grade: 'C+', note: ''},
            {year: '2025', semester: '1í•™ê¸°', type: 'ì •ê·œí•™ê¸°', category: 'ì¼ë°˜ì„ íƒ', subject: 'ë…¼ë¦¬ì ì‚¬ê³ ì™€ìˆ˜ë¦¬', credit: '3.0', grade: 'S', note: ''},
            {year: '2025', semester: '1í•™ê¸°', type: 'ì •ê·œí•™ê¸°', category: 'ì „ê³µí•„ìˆ˜', subject: 'ê²½ì˜ì •ë³´ì‹œìŠ¤í…œ', credit: '3.0', grade: 'C+', note: ''}
        ];

        // íƒ­ ì „í™˜
        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));

            document.getElementById(tabName).classList.add('active');
            event.target.classList.add('active');

            // ê° íƒ­ ë¡œë“œ
            if (tabName === 'grades') loadGrades();
            else if (tabName === 'certifications') loadCertifications();
            else if (tabName === 'awards') loadAwards();
            else if (tabName === 'activities') loadActivities();
            else if (tabName === 'projects') loadProjects();
            else if (tabName === 'career') loadCareer();
        }

        // ì „ì—­ ë³€ìˆ˜
        let currentEditType = '';
        let currentEditIndex = -1;

        // ì„±ì  ë°ì´í„° ë¡œë“œ
        function loadGrades() {
            const tbody = document.getElementById('grades-tbody');
            let html = '';
            gradesData.forEach((row, idx) => {
                html += `
                    <tr>
                        <td>${row.year}</td>
                        <td>${row.semester}</td>
                        <td>${row.type}</td>
                        <td>${row.category}</td>
                        <td>${row.subject}</td>
                        <td>${row.credit}</td>
                        <td>${row.grade}</td>
                        <td>${row.note}</td>
                        <td class="action-cell">
                            <button class="btn btn-small" onclick="editGrade(${idx})">âœï¸</button>
                            <button class="btn btn-small btn-danger" onclick="deleteGrade(${idx})">ğŸ—‘ï¸</button>
                        </td>
                    </tr>
                `;
            });
            tbody.innerHTML = html;
        }

        // ì„±ì  ìˆ˜ì •
        function editGrade(idx) {
            currentEditType = 'grade';
            currentEditIndex = idx;
            const data = gradesData[idx];

            document.getElementById('modal-title').textContent = 'ì„±ì  ìˆ˜ì •';
            document.getElementById('modal-body').innerHTML = `
                <div class="form-group">
                    <label>í•™ë…„ë„</label>
                    <input type="text" id="edit-year" value="${data.year}">
                </div>
                <div class="form-group">
                    <label>í•™ê¸°</label>
                    <input type="text" id="edit-semester" value="${data.semester}">
                </div>
                <div class="form-group">
                    <label>ì„±ì ë¶„ë¥˜</label>
                    <input type="text" id="edit-type" value="${data.type}">
                </div>
                <div class="form-group">
                    <label>êµê³¼êµ¬ë¶„</label>
                    <input type="text" id="edit-category" value="${data.category}">
                </div>
                <div class="form-group">
                    <label>êµê³¼ëª©ëª…</label>
                    <input type="text" id="edit-subject" value="${data.subject}">
                </div>
                <div class="form-group">
                    <label>í•™ì </label>
                    <input type="text" id="edit-credit" value="${data.credit}">
                </div>
                <div class="form-group">
                    <label>ì„±ì ë“±ê¸‰</label>
                    <input type="text" id="edit-grade" value="${data.grade}">
                </div>
                <div class="form-group">
                    <label>ë¹„ê³ </label>
                    <input type="text" id="edit-note" value="${data.note}">
                </div>
            `;
            document.getElementById('modal').classList.add('active');
        }

        // ì„±ì  ì‚­ì œ
        function deleteGrade(idx) {
            if (confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                gradesData.splice(idx, 1);
                loadGrades();
                alert('ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
            }
        }

        // ëª¨ë‹¬ ì—´ê¸°
        function openAddModal(type) {
            currentEditType = type;
            currentEditIndex = -1;

            if (type === 'grade') {
                document.getElementById('modal-title').textContent = 'ì„±ì  ì¶”ê°€';
                document.getElementById('modal-body').innerHTML = `
                    <div class="form-group">
                        <label>í•™ë…„ë„</label>
                        <input type="text" id="edit-year" placeholder="ì˜ˆ: 2025">
                    </div>
                    <div class="form-group">
                        <label>í•™ê¸°</label>
                        <input type="text" id="edit-semester" placeholder="ì˜ˆ: 1í•™ê¸°">
                    </div>
                    <div class="form-group">
                        <label>ì„±ì ë¶„ë¥˜</label>
                        <input type="text" id="edit-type" value="ì •ê·œí•™ê¸°">
                    </div>
                    <div class="form-group">
                        <label>êµê³¼êµ¬ë¶„</label>
                        <select id="edit-category">
                            <option>êµì–‘ì„ íƒ</option>
                            <option>êµì–‘í•„ìˆ˜</option>
                            <option>ì „ê³µì„ íƒ</option>
                            <option>ì „ê³µí•„ìˆ˜</option>
                            <option>ì „ê³µê¸°ì´ˆ</option>
                            <option>ë¶€ì „ê³µ</option>
                            <option>ì¼ë°˜ì„ íƒ</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>êµê³¼ëª©ëª…</label>
                        <input type="text" id="edit-subject">
                    </div>
                    <div class="form-group">
                        <label>í•™ì </label>
                        <input type="text" id="edit-credit" placeholder="ì˜ˆ: 3.0">
                    </div>
                    <div class="form-group">
                        <label>ì„±ì ë“±ê¸‰</label>
                        <select id="edit-grade">
                            <option>A+</option>
                            <option>A0</option>
                            <option>B+</option>
                            <option>B0</option>
                            <option>C+</option>
                            <option>C0</option>
                            <option>D+</option>
                            <option>D0</option>
                            <option>F</option>
                            <option>S</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>ë¹„ê³ </label>
                        <input type="text" id="edit-note" placeholder="ì„ íƒì‚¬í•­">
                    </div>
                `;
            } else if (type === 'cert') {
                document.getElementById('modal-title').textContent = 'ìê²©ì¦ ì¶”ê°€';
                document.getElementById('modal-body').innerHTML = `
                    <div class="form-group">
                        <label>ìê²©ì¦ëª…</label>
                        <input type="text" id="edit-cert-name">
                    </div>
                    <div class="form-group">
                        <label>ë“±ê¸‰</label>
                        <input type="text" id="edit-cert-grade" placeholder="ì˜ˆ: 1ê¸‰, 2ê¸‰ ë˜ëŠ” -">
                    </div>
                    <div class="form-group">
                        <label>ë°œí–‰ì²˜</label>
                        <input type="text" id="edit-cert-issuer">
                    </div>
                    <div class="form-group">
                        <label>ì·¨ë“ì¼</label>
                        <input type="text" id="edit-cert-date" placeholder="ì˜ˆ: 2025-12">
                    </div>
                    <div class="form-group">
                        <label>ìê²©ì¦ë²ˆí˜¸</label>
                        <input type="text" id="edit-cert-number">
                    </div>
                `;
            }

            document.getElementById('modal').classList.add('active');
        }

        // ëª¨ë‹¬ ë‹«ê¸°
        function closeModal() {
            document.getElementById('modal').classList.remove('active');
            currentEditType = '';
            currentEditIndex = -1;
        }

        // ë°ì´í„° ì €ì¥
        function saveData() {
            if (currentEditType === 'grade') {
                const newData = {
                    year: document.getElementById('edit-year').value,
                    semester: document.getElementById('edit-semester').value,
                    type: document.getElementById('edit-type').value,
                    category: document.getElementById('edit-category').value,
                    subject: document.getElementById('edit-subject').value,
                    credit: document.getElementById('edit-credit').value,
                    grade: document.getElementById('edit-grade').value,
                    note: document.getElementById('edit-note').value
                };

                if (currentEditIndex >= 0) {
                    // ìˆ˜ì •
                    gradesData[currentEditIndex] = newData;
                    alert('ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.');
                } else {
                    // ì¶”ê°€
                    gradesData.push(newData);
                    alert('ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.');
                }
                loadGrades();
            } else if (currentEditType === 'cert') {
                const certName = document.getElementById('edit-cert-name').value;
                const certGrade = document.getElementById('edit-cert-grade').value;
                const certIssuer = document.getElementById('edit-cert-issuer').value;
                const certDate = document.getElementById('edit-cert-date').value;
                const certNumber = document.getElementById('edit-cert-number').value;

                // ë¡œì»¬ìŠ¤í† ë¦¬ì§€ì— ì €ì¥ (ê°„ë‹¨í•œ êµ¬í˜„)
                alert('ìê²©ì¦ì´ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!\n\n' +
                      'ìê²©ì¦ëª…: ' + certName + '\n' +
                      'ë“±ê¸‰: ' + certGrade + '\n' +
                      'ë°œí–‰ì²˜: ' + certIssuer + '\n' +
                      'ì·¨ë“ì¼: ' + certDate + '\n' +
                      'ë²ˆí˜¸: ' + certNumber);

                loadCertifications();
            }

            closeModal();
        }

        // ìê²©ì¦ ë¡œë“œ
        function loadCertifications() {
            fetch('/api/certifications')
                .then(r => r.json())
                .then(data => {
                    const certDetails = {
                        "ë¹…ë°ì´í„°ë¶„ì„ê¸°ì‚¬": { grade: "-", number: "BAE-011004931" },
                        "ì •ë³´ì²˜ë¦¬ê¸°ì‚¬": { grade: "-", number: "25202210599D" },
                        "ì‚¬íšŒì¡°ì‚¬ë¶„ì„ì‚¬ 2ê¸‰": { grade: "2ê¸‰", number: "25201212511E" },
                        "SQLD": { grade: "-", number: "SQLD-055019327" },
                        "ADsP": { grade: "-", number: "ADsP-042018438" },
                        "CAD 2ê¸‰": { grade: "2ê¸‰", number: "CATCA22410723417" },
                        "ì»´í™œ 1ê¸‰": { grade: "1ê¸‰", number: "24-K9-019043" },
                        "GTQi ì¼ëŸ¬ìŠ¤íŠ¸ 1ê¸‰": { grade: "1ê¸‰", number: "GAL01241020581" },
                        "GTQ í¬í† ìƒµ 1ê¸‰": { grade: "1ê¸‰", number: "GA10124101052189" }
                    };

                    let html = '';
                    data.forEach((cert, idx) => {
                        const details = certDetails[cert.name] || { grade: "-", number: "-" };
                        html += `
                            <tr>
                                <td>${idx + 1}</td>
                                <td>${cert.name}</td>
                                <td>${details.grade}</td>
                                <td>${cert.issuer}</td>
                                <td>${cert.date}</td>
                                <td>${details.number}</td>
                            </tr>
                        `;
                    });
                    document.getElementById('cert-tbody').innerHTML = html;
                });
        }

        // ìˆ˜ìƒ ë¡œë“œ
        function loadAwards() {
            fetch('/api/awards')
                .then(r => r.json())
                .then(data => {
                    let html = '';
                    data.forEach((award, idx) => {
                        html += `
                            <tr>
                                <td>${idx + 1}</td>
                                <td>${award.name}</td>
                                <td>${award.organization}</td>
                                <td>${award.date}</td>
                            </tr>
                        `;
                    });
                    document.getElementById('awards-tbody').innerHTML = html;
                });
        }

        // í™œë™ ë¡œë“œ
        function loadActivities() {
            fetch('/api/activities')
                .then(r => r.json())
                .then(data => {
                    let html = '';
                    data.forEach((act, idx) => {
                        html += `
                            <tr>
                                <td>${idx + 1}</td>
                                <td>${act.name}</td>
                                <td>${act.organization}</td>
                                <td>${act.start_date}</td>
                                <td>${act.end_date}</td>
                                <td>${act.description}</td>
                            </tr>
                        `;
                    });
                    document.getElementById('activities-tbody').innerHTML = html;
                });
        }

        // í”„ë¡œì íŠ¸ ë¡œë“œ
        function loadProjects() {
            fetch('/api/projects')
                .then(r => r.json())
                .then(data => {
                    let html = '';
                    data.forEach((proj, idx) => {
                        html += `
                            <tr>
                                <td>${idx + 1}</td>
                                <td>${proj.name}</td>
                                <td>${proj.date}</td>
                                <td>${proj.team_size}</td>
                                <td>${proj.role || '-'}</td>
                                <td>${proj.tech_stack.join(', ')}</td>
                                <td>${proj.description}</td>
                            </tr>
                        `;
                    });
                    document.getElementById('projects-tbody').innerHTML = html;
                });
        }

        // ê²½ë ¥ ë¡œë“œ
        function loadCareer() {
            fetch('/api/career')
                .then(r => r.json())
                .then(data => {
                    let html = '';
                    data.forEach((career, idx) => {
                        html += `
                            <tr>
                                <td>${idx + 1}</td>
                                <td>${career.company}</td>
                                <td>${career.position}</td>
                                <td>${career.start_date}</td>
                                <td>${career.end_date}</td>
                                <td>${career.description}</td>
                            </tr>
                        `;
                    });
                    document.getElementById('career-tbody').innerHTML = html;
                });
        }

        // í‘œ ë³µì‚¬
        function copyTable(tableId) {
            const table = document.getElementById(tableId);
            const range = document.createRange();
            range.selectNode(table);
            window.getSelection().removeAllRanges();
            window.getSelection().addRange(range);
            document.execCommand('copy');
            window.getSelection().removeAllRanges();
            alert('âœ… í‘œê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤! ì—‘ì…€ì´ë‚˜ ì›Œë“œì— Ctrl+Vë¡œ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”.');
        }

        // ì—‘ì…€ ë‹¤ìš´ë¡œë“œ
        function downloadExcel(type) {
            const tableIds = {
                'grades': 'grades-table',
                'certifications': 'cert-table',
                'awards': 'awards-table',
                'activities': 'activities-table',
                'projects': 'projects-table',
                'career': 'career-table'
            };
            const filenames = {
                'grades': 'ì–‘í•œë¹ˆ_ì„±ì .xls',
                'certifications': 'ì–‘í•œë¹ˆ_ìê²©ì¦.xls',
                'awards': 'ì–‘í•œë¹ˆ_ìˆ˜ìƒ.xls',
                'activities': 'ì–‘í•œë¹ˆ_í™œë™.xls',
                'projects': 'ì–‘í•œë¹ˆ_í”„ë¡œì íŠ¸.xls',
                'career': 'ì–‘í•œë¹ˆ_ê²½ë ¥.xls'
            };

            const table = document.getElementById(tableIds[type]);
            const html = table.outerHTML;
            const url = 'data:application/vnd.ms-excel,' + encodeURIComponent(html);
            const link = document.createElement('a');
            link.href = url;
            link.download = filenames[type];
            link.click();
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì„±ì  ë°ì´í„° í‘œì‹œ
        window.onload = function() {
            loadGrades();
        };
    </script>
</body>
</html>
